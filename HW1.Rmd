---
title: "HW1"
author: "John Baker"
date: "1/30/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Prepare environment
```{r}
#Remove objects from the environment
rm(list = ls())
```

## Load and preview data
```{r}
df <- read.csv("HW1 Data.csv")
head(df)
```
\newpage
**Q1.** Show the proportion of Republican states and Democratic states in 2016. Discuss which political stance had an advantage in the 2016 presidential
election.
```{r}
obs <- data.frame(table(df$Presidential.Election))
barplot(
  height = obs$Freq,
  names = obs$Var1,
  col = c("#1405BD", "#DE0100"),
  yaxt = "n"
)
axis(2,
     at = pretty(0:30),
     labels = paste0((pretty(0:30) / 50) * 100, "%"),
     las = TRUE)
```
**Findings** Democrats held 40% of the states in 2016, while Republicans
controlled 60%. Therefore, the Republicans had the advantage during the
presidential election.
\newpage
**Q2.** Use a scatterplot to show the relationship between the median state
income and median house price (put house price in the y-axis). Discuss the relationship pattern (positive/negative, linear/nonlinear, weak/strong).
```{r}
#Load ggplot2
library(ggplot2)
ggplot(data = df, aes(x = Income / 1000, y = House.Value / 1000)) + 
  geom_point() + geom_smooth(
  formula = y ~ x,
  method = lm ,
  color = "red",
  fill = "#69B3A2",
  se = FALSE
) + xlab("Income (in Thousands USD)") + ylab("House Value (in Thousands USD)")
```
**Findings** Median income and median house price follow a solid positive linear relationship. Typically, house value increases at a constant rate when income increases.
\newpage
**Q3.** Use a boxplot and histogram to show the distribution of median state
income. Discuss whether there is an outlier for the *Income* and whether median
state income exhibits symmetric distribution.
```{r}
boxplot(df$Income / 1000, col = "#A09764", ylab = "Income (in Thousands USD)")
hist(df$Income / 1000,
     col = "#A09764",
     xlab = "Income (in Thousands USD)",
     main = "Income")
```
**Findings** No income outlier is detected. As the histogram is right-skewed,
the median state income does not exhibit symmetric distribution.
\newpage
**Q4.** Repeat the same analysis in Q3 for the variable *House.Value*.
```{r}
boxplot(df$House.Value / 1000, col = "#9764A0", ylab = "House Value (in Thousands USD)")
hist(df$House.Value / 1000,
     col = "#9764A0",
     xlab = "House Value (in Thousands USD)",
     main = "House Value")
```
**Findings** There are two outliers in house value that are very high. As the histogram is right-skewed, the median house value does not exhibit symmetric distribution.
\newpage
**Q5.** Use a boxplot by categories to show whether political stances affect the proportional distribution of foreigners and the distribution of high-school
degree holders. Discuss which political stance is associated with a higher
proportion of foreigners and which is associated with a higher proportion of
high school degree holders.
```{r}
boxplot(
  df$Foreign.Born ~ df$Presidential.Election,
  col = c("#1405BD", "#DE0100"),
  xlab = "",
  ylab = "Foreign-Born"
)
boxplot(
  df$HS.Diploma ~ df$Presidential.Election,
  col = c("#1405BD", "#DE0100"),
  xlab = "",
  ylab = "High School Diploma"
)
```
**Findings** Foreigners tend to be Democratic, while high school graduates tend
to be republican.
\newpage
**Q6.** Use a scatter plot to show whether the proportion of foreigners is
associated with the balance of high school degree holders (put high-school
degree proportion in the y-axis). Use a second conditional scatter plot to
illustrate whether this relationship is affected by the political stance. Draw
your conclusions explicitly.
```{r}
plot(
  df$Foreign.Born,
  df$HS.Diploma,
  col = "#1405BD",
  xlab = "Foreign-Born",
  ylab = "High School Degree Holders"
)
```
\newpage
```{r}
#Load car
library(car)
scatterplot(
  HS.Diploma ~ Foreign.Born | Presidential.Election,
  data = df,
  boxplots = FALSE,
  xlab = "Foreign-Born",
  ylab = "High School Degree Holders",
)
```
**Findings** There does not appear to be a correlation between political parties
when looking at foreign-born people and high school graduates. Most foreign-born people tend to be Democratic, regardless of high school graduation status.